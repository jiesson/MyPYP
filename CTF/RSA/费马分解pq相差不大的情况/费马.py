#当pq差值不大时，可通过费马定理猜解出pq
#x^2-n=y^2
def isqrt(n):
  x = n
  y = (x + n // x) // 2
  while y < x:
    x = y
    y = (x + n // x) // 2
  return x

def fermat(n, verbose=True):
    x = isqrt(n) # x=根号n
    y2 = x*x - n
    y = isqrt(n) # int(b2**0.5)
    count = 0
    while y*y != y2:
        if verbose:
            print('Trying: a=%s b2=%s b=%s' % (x, y2, y))
        x = x + 1
        y2 = x*x - n
        y = isqrt(y2) # int(b2**0.5)
        count += 1
    p=x+y
    q=x-y
    assert n == p * q
    print('x=',x)
    print('y=',y)
    print('p=',p)
    print('q=',q)
    print('pq=',p*q)
    return p, q

n=636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163
fermat(n)
#print(isqrt(16))
